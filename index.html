<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<link rel="icon" href="images/bin-thicker-outline-32x32.png" />
	<title>Junkbot</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<meta name="description" content="A remake of Junkbot and Junkbot Undercover LEGO games">
	<style>
		html,
		body {
			overflow: hidden;
			margin: 0;
			padding: 0;
			border: 0;
			width: 100%;
			height: 100%;
			user-select: none;
		}

		#main-controls {
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			z-index: 2;
			background-color: #000;
			color: #fff;
			display: flex;
			padding: 2px;
			gap: 2px;
			justify-content: flex-end;
		}
		/* prevent occlusion of entities palette */
		@media screen and (min-width: 400px) {
			#main-controls {
				left: unset;
			}
		}
		/* approximate width of editor UI + main controls */
		@media screen and (max-width: 800px) {
			#editor-ui {
				padding-top: 50px;
			}
		}

		#main-controls button {
			font-size: 30px;
			height: 40px;
			width: 40px;
			padding: 0;
			display: inline-flex;
			align-items: center;
			justify-content: center;
		}

		#info {
			position: fixed;
			right: 15px;
			top: 15px;
			z-index: 1;
			max-width: 800px;
			max-height: calc(100% - 30px);
			box-sizing: border-box;
			background: white;
			color: black;
			padding: 15px;
			line-height: 1.5;
			overflow: auto;
			box-shadow: 1px 2px 5px rgba(0, 0, 0, 0.5);
			border-radius: 5px;
			user-select: text;
		}

		table {
			border-spacing: 0;
			border-collapse: collapse;
			margin-top: 0;
			margin-bottom: 16px;
		}

		kbd {
			display: inline-block;
			padding: 3px 5px;
			font: 11px SFMono-Regular, Consolas, Liberation Mono, Menlo, monospace;
			line-height: 10px;
			color: #444d56;
			vertical-align: middle;
			background-color: #fafbfc;
			border: 1px solid #d1d5da;
			border-radius: 6px;
			box-shadow: inset 0 -1px 0 #d1d5da;
		}

		td button {
			text-align: left;
			margin-left: 10px;
		}

		.dialog-container {
			position: fixed;
			left: 0;
			top: 0;
			right: 0;
			bottom: 0;
			display: flex;
			justify-content: center;
			align-items: center;
			pointer-events: none;
		}

		.dialog {
			min-width: 300px;
			max-width: 90vw;
			z-index: 100;
			padding: 20px;
			background: white;
			color: black;
			pointer-events: all;
		}

		.message-content {
			max-height: 70vh;
			overflow-y: auto;
		}

		#tests-ui:not([hidden]) {
			position: fixed;
			right: 0px;
			top: 0px;
			bottom: 0px;
			background-color: white;
			color: black;
			display: flex;
			flex-direction: column;
		}

		#tests {
			overflow: auto;
			flex: 1;
		}

		#editor-ui:not([hidden]) {
			position: fixed;
			left: 0px;
			top: 0px;
			bottom: 0px;
			background-color: #224;
			color: white;
			display: flex;
			flex-direction: column;
		}

		#entities-scroll-container {
			/* assuming scrollbar takes up less than 20px */
			width: 320px;
			overflow-y: auto;
			background-color: black;
			flex: 1;
		}

		#entities-palette {
			width: 300px;
		}

		.controls>*,
		.level>*,
		#level-select {
			margin: 10px;
		}

		#level-select {
			margin-top: 2px;
		}

		#open-world {
			margin-left: 0px;
		}

		.level {
			display: flex;
			flex-direction: column;
		}

		.label-input-row {
			display: flex;
			flex-direction: row;
		}

		.label-input-row label {
			width: 50px;
			align-self: center;
		}

		#title-screen {
			background-image: url("images/menus/neo_title.png");
			width: 650px;
			height: 420px;
			z-index: 10000;
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			outline: 5000px solid black; /* covers up a few pixels of the title screen level outside its frame */
			pointer-events: none; /* allows interaction with the title screen level through the frame's cutout */
		}
		#title-screen>*:not([hidden]):not(#welcome-text) {
			pointer-events: all;
		}

		#welcome-text {
			text-align: center;
			background-image: url("images/menus/loading_bkg_frame.png");
			width: 398px;
			height: 86px;
			position: absolute;
			left: 41px;
			top: 206px;
			color: black;
		}
		.image-button {
			border: 0;
			background-color: transparent;
			color: transparent;
		}
		#start-game {
			position: absolute;
			left: 139px;
			top: 148px;
			background-image: url("images/menus/play_default.png");
			width: 116px;
			height: 45px;
		}
		#start-game:hover {
			background-image: url("images/menus/play_hover.png");
		}
		#show-credits {
			position: absolute;
			left: 310px;
			top: 159px;
			background-image: url("images/menus/credit_up.png");
			width: 96px;
			height: 26px;
		}
		#show-credits:hover {
			background-image: url("images/menus/credit_up_x.png");
		}
		#skip-intro,
		#replay-intro {
			position: absolute;
			left: 508px;
			top: 337px;
			width: 96px;
			height: 26px;
		}
		#skip-intro {
			background-image: url("images/menus/skip_intro.png");
		}
		#skip-intro:hover {
			background-image: url("images/menus/skip_intro_x.png");
		}
		#replay-intro {
			background-image: url("images/menus/replay_intro.png");
		}
		#replay-intro:hover {
			background-image: url("images/menus/replay_intro_x.png");
		}
		#reset-screen {
			position: absolute;
			left: 508px;
			top: 367px;
			background-image: url("images/menus/clear_screen.png");
			width: 96px;
			height: 26px;
		}
		#reset-screen:hover {
			background-image: url("images/menus/clear_screen_x.png");
		}
		#load-status {
			position: absolute;
			left: 508px;
			top: 15px;
			width: 100px;
			height: 40px;
			font-size: 14px;
			line-height: 19px;
			display: flex;
			align-items: center;
			justify-content: center;
			text-align: center;
			color: #636363;
		}
		.title-screen-arrow {
			position: absolute;
			top: 152px;
			background-image: url("images/menus/arrow.png");
			width: 45px;
			height: 37px;
			opacity: 20%;
		}
		.title-screen-arrow.pointing-left {
			transform: scaleX(-1);
		}
	</style>
</head>

<body>
	<script src="lib/jsondiffpatch.umd.js"></script>
	<script src="src/game.js"></script>
	<div id="title-screen">
		<button class="image-button" id="start-game">Play</button>
		<button class="image-button" id="show-credits">Credits</button>
		<button class="image-button" id="replay-intro" hidden>Replay Intro</button>
		<button class="image-button" id="skip-intro" hidden>Skip Intro</button>
		<button class="image-button" id="reset-screen">Reset Screen</button>
		<span id="load-status">
			<span id="load-status-text-loaded" hidden>Ready to play</span>
			<span id="load-status-text-loading">Loading...</span>
		</span>
		<div id="welcome-text">
			Welcome to the factory<br>
			<span style="color: white">Try moving the colored bricks<br>
			with the mouse</span><br>
			before you play the game
		</div>
		<div class="title-screen-arrow" style="left: 34px;"></div>
		<div class="title-screen-arrow" style="left: 85px;"></div>
		<div class="title-screen-arrow pointing-left" style="left: 260px;"></div>
		<div class="title-screen-arrow pointing-left" style="left: 407px;"></div>
	</div>
	<div id="main-controls">
		<!-- aria-keyshortcuts="Shift" is invalid, but what are you gonna do? -->
		<button id="rewind" aria-label="Rewind" aria-keyshortcuts="Shift">
			<!-- @TODO: proper icon, or dynamic control for rewind/fast-forward -->
			‚è™
		</button>
		<button id="toggle-editing" aria-label="Edit level" aria-pressed="false" aria-keyshortcuts="E">
			<!-- @TODO: proper icon; emoji for now -->
			‚úèÔ∏è
		</button>
		<!-- <button id="toggle-music" aria-label="Music" aria-pressed="false" aria-keyshortcuts="M">
			<svg fill="currentColor" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
				<g transform="translate(-3.631 -5.26) scale(.025)">
					<path class="fill-cc" d="M301.429 312.422l372.684-76v103.929l-372.684 76z"></path>
					<path class="fill-cc" d="M301.429 312.342h60v388.5h-60z"></path>
					<ellipse class="fill-cc" cx="-165" cy="470.362" rx="125" ry="78" transform="matrix(.77274 -.20706 .24886 .92877 273.331 240.338)"></ellipse>
					<path class="fill-cc" d="M614.113 248.877h60v388.5h-60z"></path>
					<ellipse class="fill-cc" cx="-165" cy="470.362" rx="125" ry="78" transform="matrix(.77274 -.20706 .24886 .92877 586.016 176.873)"></ellipse>
				</g>
			</svg>
		</button> -->
		<button id="toggle-mute" aria-label="Mute" aria-pressed="false" aria-keyshortcuts="M">
			<!-- @TODO: proper icon; note that emoji content is replaced when toggled -->
			üîà
		</button>
		<input id="volume-slider" type="range" min="0" max="1" step="0.01" value="0.5" aria-label="Volume">
		<button id="toggle-fullscreen" aria-label="Toggle Fullscreen" aria-pressed="false" aria-keyshortcuts="Alt+Enter F11">
			<svg fill="currentColor" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg"
				viewBox="0 0 438.543 438.543">
				<path
					d="M407.42 159.029c3.62 3.616 7.898 5.428 12.847 5.428 2.282 0 4.668-.476 7.139-1.429 7.426-3.235 11.136-8.853 11.136-16.846V18.276c0-4.949-1.807-9.231-5.428-12.847-3.61-3.617-7.898-5.424-12.847-5.424H292.36c-7.991 0-13.607 3.805-16.848 11.419-3.23 7.423-1.902 13.99 4 19.698l41.111 41.112-101.352 101.355L117.917 72.231l41.112-41.112c5.901-5.708 7.232-12.275 3.999-19.698C159.789 3.807 154.175 0 146.182 0H18.276C13.324 0 9.041 1.809 5.425 5.426 1.808 9.042.001 13.324.001 18.273V146.18c0 7.996 3.809 13.61 11.419 16.846 2.285.948 4.57 1.429 6.855 1.429 4.948 0 9.229-1.812 12.847-5.427l41.112-41.109 101.354 101.354L72.234 320.622l-41.112-41.113c-5.711-5.903-12.275-7.231-19.702-4.001C3.806 278.749.001 284.364.001 292.362v127.906c0 4.948 1.807 9.229 5.424 12.847 3.619 3.614 7.902 5.421 12.851 5.421h127.906c7.996 0 13.61-3.806 16.846-11.416 3.234-7.427 1.903-13.99-3.999-19.705l-41.112-41.106L219.271 264.95l101.353 101.361-41.114 41.11c-5.899 5.708-7.228 12.279-3.997 19.698 3.237 7.617 8.856 11.423 16.851 11.423h127.907c4.948 0 9.232-1.813 12.847-5.428 3.613-3.613 5.42-7.898 5.42-12.847V292.362c0-7.994-3.709-13.613-11.136-16.851-7.802-3.23-14.462-1.903-19.985 4.004l-41.106 41.106-101.359-101.35L366.31 117.917l41.11 41.112z">
				</path>
			</svg>
		</button>
		<button id="toggle-info" aria-label="Toggle Info" aria-expanded="true">
			<svg fill="currentColor" width="1em" height="1em" viewBox="0 0 40 40">
				<path
					d="m18.4 15v-3.4h3.2v3.4h-3.2z m1.6 18.4c7.3 0 13.4-6.1 13.4-13.4s-6.1-13.4-13.4-13.4-13.4 6.1-13.4 13.4 6.1 13.4 13.4 13.4z m0-30c9.2 0 16.6 7.4 16.6 16.6s-7.4 16.6-16.6 16.6-16.6-7.4-16.6-16.6 7.4-16.6 16.6-16.6z m-1.6 25v-10h3.2v10h-3.2z">
				</path>
			</svg>
		</button>
	</div>
	<div id="info">
		<h1>Janitorial Android (Junkbot)</h1>
		<a href="https://github.com/1j01/janitorial-android">Source Code on GitHub</a>
		<h2>Controls</h2>
		<p>Drag bricks with the mouse. You don't control Junkbot directly. Junkbot moves on their own.</p>
		<p>Use the arrow keys or <kbd>WASD</kbd> (on QWERTY keyboard, something else on AZERTY), or move the mouse to
			the edges of screen to pan the view and look around.</p>
		<table>
			<tr>
				<td><kbd>E</kbd></td>
				<td>Toggle edit mode</td>
			</tr>
			<!-- <tr>
				<td><kbd>P</kbd> or <kbd>Spacebar</kbd></td>
				<td>Pause / unpause</td>
			</tr> -->
			<tr>
				<td><kbd>M</kbd></td>
				<td>Mute / unmute</td>
			</tr>
			<tr>
				<td><kbd>+</kbd></td>
				<td>Zoom in</td>
			</tr>
			<tr>
				<td><kbd>-</kbd></td>
				<td>Zoom out</td>
			</tr>
			<tr>
				<td><kbd>`</kbd></td>
				<td>Toggle debug information (including collision and NaN detection)</td>
			</tr>
		</table>
		<p>When in editor mode:</p>
		<p>Click on the background and drag to select objects within a rectangle.</p>
		<p>Hold <kbd>Ctrl</kbd> and click to drag an individual object.</p>
		<table>
			<tr>
				<td><kbd>Ctrl+C</kbd></td>
				<td>Copy selected to clipboard</td>
			</tr>
			<tr>
				<td><kbd>Ctrl+X</kbd></td>
				<td>Cut selected to clipboard</td>
			</tr>
			<tr>
				<td><kbd>Ctrl+V</kbd></td>
				<td>Paste from clipboard</td>
			</tr>
			<tr>
				<td><kbd>Delete</kbd></td>
				<td>Delete selected</td>
			</tr>
			<tr>
				<td><kbd>F</kbd></td>
				<td>Flip selected horizontally</td>
			</tr>
			<tr>
				<td><kbd>T</kbd></td>
				<td>Toggle selected switches/things</td>
			</tr>
			<tr>
				<td><kbd>Ctrl+Z</kbd></td>
				<td>Undo</td>
			</tr>
			<tr>
				<td><kbd>Ctrl+Shift+Z</kbd> or <kbd>Ctrl+Y</kbd></td>
				<td>Redo</td>
			</tr>
			<tr>
				<td><kbd>Ctrl+A</kbd></td>
				<td>Select all</td>
			</tr>
			<tr>
				<td><kbd>Ctrl+S</kbd></td>
				<td>Save world to a file</td>
			</tr>
			<tr>
				<td><kbd>Ctrl+O</kbd></td>
				<td>Open a saved world file</td>
			</tr>
		</table>
	</div>
	<div id="tests-ui" hidden>
		<div class="label-input-row">
			<label for="test-speed">Simulation Speed:</label>
			<input type="range" min="1" max="100" step="1" id="test-speed">
		</div>
		<!-- <button id="start-tests">Start/Restart Tests</button> -->
		<div id="tests-info"></div>
		<ul id="tests"></ul>
	</div>
	<div id="editor-ui">
		<!-- wrapper to make layout consistent regardless of scrollbar, without using overflow: auto -->
		<div id="entities-scroll-container">
			<div id="entities-palette"></div>
		</div>
		<div class="controls">
			<div class="level">
				<div class="label-input-row">
					<label for="level-title-input">Title:</label>
					<input type="text" id="level-title-input" />
				</div>
				<div class="label-input-row">
					<label for="level-hint-input">Hint:</label>
					<input type="text" id="level-hint-input" />
				</div>
				<div class="label-input-row">
					<label for="level-par-input">Par:</label>
					<input type="number" id="level-par-input" min="0" step="1" />
				</div>
				<div>
					<label for="level-bounds-checkbox">
						<input type="checkbox" id="level-bounds-checkbox">
						Level Bounds
					</label>
				</div>
			</div>
			<button id="save-world">Save World</button>
			<button id="open-world">Open World</button>
			<br>
			<label>
				Choose Level:<br>
				<select id="level-select"></select>
			</label>
		</div>
	</div>
</body>

</html>